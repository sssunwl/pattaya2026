<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Ê≥∞ÂòÜËä≠Â†§ÈõÖüáπüá≠Êñ∞Âπ¥Â∫¶ÂÅáÂúò</title>
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/2060/2060206.png">
    
    <!-- Ê†∏ÂøÉÂ∫´ -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;500;700;900&family=Playfair+Display:wght@700&display=swap');
        
        :root { --safe-top: env(safe-area-inset-top); --safe-bottom: env(safe-area-inset-bottom); }

        body {
            font-family: 'Zen Maru Gothic', sans-serif;
            background-color: #F5F2ED; 
            color: #4A4A4A;
            -webkit-tap-highlight-color: transparent;
            padding-bottom: var(--safe-bottom);
            margin: 0;
            overflow-x: hidden;
            background-image: 
                linear-gradient(to bottom, rgba(245, 242, 237, 0.85), rgba(245, 242, 237, 0.95)),
                url('https://images.unsplash.com/photo-1507525428034-b723cf961d3e?w=800&q=80');
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
        }

        .font-serif { font-family: 'Playfair Display', serif; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* Animation */
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.3s ease-out forwards; }
        .animate-slide-up { animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards; }

        /* Navigation */
        .sticky-nav-container { position: sticky; top: 54px; z-index: 50; display: flex; align-items: flex-start; gap: 12px; width: 100%; pointer-events: none; margin-bottom: 20px; margin-top: 10px; padding: 0 16px; }
        .menu-btn-wrapper { pointer-events: auto; width: 48px; height: 48px; background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(8px); border-radius: 14px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 15px rgba(0,0,0,0.1); border: 1px solid rgba(255,255,255,0.6); cursor: pointer; transition: transform 0.1s; z-index: 101; flex-shrink: 0; }
        .menu-btn-wrapper:active { transform: scale(0.95); }
        
        /* Fixed Menu Dropdown - Âõ∫ÂÆöÂÆö‰ΩçÔºåÈò≤Ê≠¢Ë¢´ÈÅÆÊìã */
        .menu-dropdown { 
            position: fixed; 
            top: 110px; 
            left: 16px; 
            width: 60px; 
            background: rgba(255, 255, 255, 0.98); 
            backdrop-filter: blur(20px); 
            border-radius: 16px; 
            padding: 8px 0; 
            box-shadow: 0 10px 40px rgba(0,0,0,0.15); 
            display: flex; flex-direction: column; align-items: center; gap: 12px; 
            border: 1px solid rgba(255,255,255,0.6); 
            pointer-events: auto; 
            z-index: 1000; 
            animation: fadeIn 0.2s ease-out; 
        }
        .menu-item { display: flex; flex-direction: column; align-items: center; justify-content: center; width: 100%; padding: 6px 0; border-radius: 8px; font-size: 10px; font-weight: bold; color: #4A4A4A; transition: background 0.2s; cursor: pointer; }
        .menu-item:active { background: #F3F4F6; }
        
        /* User Selection Popout - Ê©´Âêë */
        .user-popout {
            position: fixed; top: 110px; left: 84px; 
            background: rgba(255, 255, 255, 0.98); backdrop-filter: blur(20px);
            border-radius: 16px; padding: 8px; border: 1px solid rgba(255,255,255,0.6);
            display: flex; gap: 8px; box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            animation: fadeIn 0.2s ease-out; width: max-content; z-index: 1001;
            max-width: 70vw; overflow-x: auto;
        }

        .day-tabs-wrapper { pointer-events: auto; background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(12px); border-radius: 24px; padding: 4px 6px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border: 1px solid rgba(255,255,255,0.5); display: flex; gap: 6px; overflow-x: auto; width: fit-content; max-width: calc(100% - 60px); height: 52px; align-items: center; }
        .day-pill { flex-shrink: 0; width: 44px; height: 44px; border-radius: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: all 0.2s; color: #8E9AAF; background: transparent; font-size: 10px; font-weight: bold; cursor: pointer; }
        .day-pill.active { background: #E09F7D; color: white; box-shadow: 0 4px 12px rgba(224, 159, 125, 0.4); transform: scale(1.05); }

        /* Timeline */
        .timeline-line { position: absolute; left: 40px; top: 0; bottom: 0; width: 2px; background-image: linear-gradient(to bottom, #E09F7D 50%, transparent 50%); background-size: 2px 10px; background-repeat: repeat-y; z-index: 0; opacity: 0.4; }
        .timeline-circle { position: absolute; left: -56px; top: 0; z-index: 10; width: 40px; height: 40px; border-radius: 50%; background-color: #E09F7D; color: white; box-shadow: 0 2px 8px rgba(0,0,0,0.1); display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 10px; font-weight: bold; line-height: 1; border: 2px solid white; cursor: pointer; }
        
        .itinerary-header { background: white; padding: 12px 16px; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); border: 1px solid rgba(0,0,0,0.02); cursor: pointer; transition: all 0.2s; margin-left: 12px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; }
        .itinerary-header:active { transform: scale(0.98); background: #F9FAFB; }
        .event-card { transition: all 0.2s cubic-bezier(0.25, 0.8, 0.25, 1); transform-origin: center left; cursor: pointer; background: white; border-radius: 1rem; padding: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); border: 1px solid rgba(0,0,0,0.02); }
        .event-card:hover { transform: scale(1.02); background-color: #FFFFFF; box-shadow: 0 8px 16px rgba(0,0,0,0.1); }

        /* Modal */
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.6); backdrop-filter: blur(4px); z-index: 70; display: flex; flex-direction: column; justify-content: flex-end; animation: fadeIn 0.2s ease-out; }
        .modal-content { background: #FFFFFF; width: 100%; max-height: 85vh; border-top-left-radius: 2rem; border-top-right-radius: 2rem; overflow-y: auto; box-shadow: 0 -10px 40px rgba(0,0,0,0.2); position: relative; z-index: 80; padding-bottom: 40px; animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1); }
        .modal-handle-bar { position: sticky; top: 0; width: 100%; background: white; z-index: 50; padding: 16px 0; display: flex; flex-direction: column; align-items: center; justify-content: center; border-bottom: 1px solid rgba(0,0,0,0.05); cursor: pointer; gap: 4px; }
        .modal-drag-line { width: 48px; height: 5px; background-color: #E5E7EB; border-radius: 100px; }
        .modal-close-text { font-size: 12px; color: #9CA3AF; font-weight: bold; display: flex; align-items: center; gap: 4px; }

        /* UI Utils */
        .pill-btn { padding: 8px 16px; border-radius: 20px; font-size: 12px; font-weight: bold; color: #8E9AAF; background: #FFFFFF; box-shadow: 0 2px 5px rgba(0,0,0,0.05); border: 1px solid rgba(0,0,0,0.05); white-space: nowrap; transition: all 0.2s; cursor: pointer; }
        .pill-btn.active { background: #E09F7D !important; color: #FFFFFF !important; box-shadow: 0 4px 10px rgba(224, 159, 125, 0.4); border-color: transparent; }
        
        .cat-tag { position: absolute; top: 0; left: 0; width: 24px; height: 24px; border-bottom-right-radius: 12px; color: white; display: flex; align-items: center; justify-content: center; font-size: 10px; z-index: 5; }
        .cat-bg-transport { background-color: #60A5FA; } .cat-bg-food { background-color: #F97316; } .cat-bg-shopping { background-color: #EC4899; } .cat-bg-misc { background-color: #9CA3AF; }

        .square-map { width: 100%; padding-top: 100%; position: relative; border-radius: 1.5rem; overflow: hidden; border: 1px solid rgba(0,0,0,0.05); }
        .square-map iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; }
        .grid-3-col { display: grid; grid-template-columns: repeat(3, 1fr); gap: 6px; margin-bottom: 16px; }
        .grid-3-col img { width: 100%; aspect-ratio: 1; object-fit: cover; border-radius: 12px; }
        
        /* 6-Grid Style */
        .ig-6-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 2px; margin-bottom: 16px; border-radius: 16px; overflow: hidden; }
        .ig-cell { position: relative; width: 100%; aspect-ratio: 1; background: #eee; cursor: pointer; }
        .ig-cell img { width: 100%; height: 100%; object-fit: cover; transition: opacity 0.2s; }
        .ig-center-text { grid-column: 2; grid-row: 2; background: rgba(255,255,255,0.95); display: flex; align-items: center; justify-content: center; padding: 4px; text-align: center; font-size: 10px; color: #4A4A4A; z-index: 10; border: 1px solid #E09F7D; overflow-y: auto; }
        
        .video-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 1rem; margin-bottom: 1rem; background: #000; }
        .video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }

        /* Wallet Buttons Fix */
        .btn-primary { background-color: #4A4A4A; color: white; border-radius: 12px; font-weight: bold; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .btn-primary:active { background-color: #333; transform: scale(0.98); }
        .btn-secondary { background-color: white; color: #4A4A4A; border: 1px solid #E5E7EB; border-radius: 12px; font-weight: bold; }
        .btn-secondary:active { background-color: #F3F4F6; transform: scale(0.98); }
        .filter-btn { padding: 4px 12px; border-radius: 99px; font-size: 12px; font-weight: bold; border: 1px solid #E5E7EB; color: #6B7280; background: white; white-space: nowrap; transition: all 0.2s; cursor: pointer; }
        .filter-btn.active { background-color: #4A4A4A !important; color: white !important; border-color: transparent !important; }

        /* Person Selector Scroll */
        .person-selector { display: flex; gap: 12px; overflow-x: auto; padding: 8px 0; }
        .person-item { min-width: 50px; display: flex; flex-direction: column; align-items: center; cursor: pointer; transition: all 0.2s; }
        .person-avatar { width: 44px; height: 44px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px; background: #F3F4F6; border: 2px solid transparent; transition: all 0.2s; }
        .person-item.selected .person-avatar { border-color: #E09F7D; background: #FFF; box-shadow: 0 4px 10px rgba(224, 159, 125, 0.3); transform: scale(1.1); }
        .person-item.unselected .person-avatar { opacity: 0.5; }
        .person-name { font-size: 10px; font-weight: bold; margin-top: 4px; color: #666; }
        .person-item.selected .person-name { color: #E09F7D; }

        #error-message { display: none; padding: 20px; color: red; text-align: center; background: white; height: 100vh; flex-direction: column; justify-content: center; z-index: 9999; position: fixed; top: 0; left: 0; width: 100%; }
        #loading { position: fixed; top: 0; left: 0; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; background: #F5F2ED; color: #E09F7D; font-weight: bold; z-index: 10000; }
    </style>
</head>
<body>
    <div id="root"></div>
    <div id="loading">ËºâÂÖ•‰∏≠...</div>
    <div id="error-message"></div>

    <script type="text/babel">
        // 0. Global Error Handler
        window.onerror = function(message, source, lineno, colno, error) {
            console.error(error);
            document.getElementById('loading').style.display = 'none';
            document.getElementById('root').style.display = 'none';
            const errorDiv = document.getElementById('error-message');
            errorDiv.style.display = 'flex';
            errorDiv.innerHTML = `<h3>ÂìéÂëÄÔºÅÁôºÁîüÈåØË™§</h3><p>${message}</p><p>Line: ${lineno}</p>`;
        };

        const { useState, useEffect, useRef } = React;

        /* 1. Constants & Data */
        const MEMBERS = [
            { id: 'lam', name: "Lam", avatar: "ü¶Å" }, { id: 'ricky', name: "Ricky", avatar: "üêª" }, { id: 'robin', name: "Robin", avatar: "üêØ" },
            { id: 'jolin', name: "Jolin", avatar: "üê∞" }, { id: 'pat', name: "Pat", avatar: "ü¶ä" }, { id: 'masa', name: "Masa", avatar: "üê®" },
            { id: 'yi', name: "Yi", avatar: "üêº" }, { id: 'justin', name: "Justin", avatar: "üêµ" }, { id: 'han', name: "Han", avatar: "üë∂" }
        ];

        const WEATHER_DATA = [ { date: "2/13", icon: "cloud-sun", temp: "31¬∞" }, { date: "2/14", icon: "sun", temp: "32¬∞" }, { date: "2/15", icon: "sun", temp: "29¬∞" }, { date: "2/16", icon: "sun", temp: "30¬∞" }, { date: "2/17", icon: "cloud-sun", temp: "31¬∞" }, { date: "2/18", icon: "plane", temp: "28¬∞" } ];
        
        const MOCK_GALLERY = [
            "https://images.unsplash.com/photo-1544644181-1484b3fdfc62?w=300", "https://images.unsplash.com/photo-1590523277543-a94d2e4eb00b?w=300", "https://images.unsplash.com/photo-1544551763-46a8723ba3f9?w=300",
            "https://images.unsplash.com/photo-1516916759473-600c07bc99d7?w=300", "https://images.unsplash.com/photo-1534008753122-a837cf46d288?w=300", "https://images.unsplash.com/photo-1540206395-688085723adb?w=300",
            "https://images.unsplash.com/photo-1507525428034-b723cf961d3e?w=300", "https://images.unsplash.com/photo-1506929562872-bb421503ef21?w=300", "https://images.unsplash.com/photo-1571896349842-6e5c48dc52e3?w=300"
        ];
        const IG_GALLERY = MOCK_GALLERY.map(url => ({ url, desc: "ÈªûÊìäÊü•ÁúãË©≥ÊÉÖ" }));

        const ITINERARY = [
            { day: "Day 1", date: "2/13", weekday: "(‰∫î)", theme: "„ÄåÊ≥∞„ÄçÂø´ÈñÉ", id: "d1", highlights: "ËêΩÊ©üÂç≥Ë°ùÂ§úÂ∏Ç", details: [ 
                { id: "e1", time: "14:25", title: "ÊäµÈÅî BKK Ê©üÂ†¥", desc: "Ê≥∞Ëà™ TG601 Ê∫ñÊôÇÈôçËêΩÔºåÂ∞àËªäÂ∑≤Âú®Ê©üÂ†¥Á≠âÂÄô„ÄÇ", type: "transport", img: "https://images.unsplash.com/photo-1542296332-2e449c29d009?w=800", gallery: IG_GALLERY, desc_1: "Êé•Ê©üÂ§ßÂª≥ÈõÜÂêàÔºåÂ∞àËªäËàíÈÅ©„ÄÇ", desc_2: "ËªäÁ®ãÁ¥Ñ1.5Â∞èÊôÇÔºå‰∏≠ÈÄîÂèØÂÅú‰ºëÊÅØÁ´ô„ÄÇ", location: "Suvarnabhumi Airport", thai_text: "‡∏™‡∏ô‡∏≤‡∏°‡∏ö‡∏¥‡∏ô‡∏™‡∏∏‡∏ß‡∏£‡∏£‡∏ì‡∏†‡∏π‡∏°‡∏¥" },
                { id: "e2", time: "16:30", title: "ÂÖ•‰Ωè Akara Hotel", desc: "Ëä≠Â†§ÈõÖÂåóÂçÄÁ≤æÂìÅÈÖíÂ∫óÔºåÈ†ÇÊ®ìÊ≥≥Ê±†ÁµïÁæé„ÄÇ", type: "hotel", img: "https://images.unsplash.com/photo-1566073771259-6a8506099945?w=800", gallery: IG_GALLERY, desc_1: "Ëæ¶ÁêÜÂÖ•‰ΩèÊâãÁ∫åÔºåÂàÜÈÖçÊàøÂç°„ÄÇ", desc_2: "È†ÇÊ®ìÊ≥≥Ê±†ÈñãÊîæËá≥Êôö‰∏ä10Èªû„ÄÇ", location: "Akara Hotel Pattaya", thai_text: "‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏°‡∏≠‡∏±‡∏Ñ‡∏£‡∏≤ ‡∏û‡∏±‡∏ó‡∏¢‡∏≤" },
                { id: "e3", time: "18:00", title: "È£õÊ©üÂ§úÂ∏ÇÊéÉË°ó", desc: "Â∞±Âú®ÈÖíÂ∫óÂ∞çÈù¢ÔºÅÂøÖÂêÉÈ¶ôËïâÁÖéÈ§Ö„ÄÇ", type: "activity", img: "https://images.unsplash.com/photo-1555243560-ef023c04294a?w=800", gallery: IG_GALLERY, desc_1: "ÂêÑÂºèÊ≥∞ÂúãË°óÈ†≠Â∞èÂêÉÈõ≤ÈõÜ„ÄÇ", desc_2: "Êé®Ëñ¶ÔºöËäíÊûúÁ≥ØÁ±≥È£Ø„ÄÅÁÉ§ËÇâ‰∏≤„ÄÇ", location: "Runway Street Food Pattaya", thai_text: "‡∏ï‡∏•‡∏≤‡∏î‡∏ô‡∏±‡∏î‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ö‡∏¥‡∏ô ‡∏û‡∏±‡∏ó‡∏¢‡∏≤" },
                { id: "e4", time: "19:30", title: "Ginger Farm", desc: "Á±≥ËäùËìÆÊ≥∞ÂåóËèúÔºåÁí∞Â¢ÉÂ§¢Âπª„ÄÇ", type: "food", img: "https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=800", gallery: IG_GALLERY, desc_1: "‰æÜËá™Ê∏ÖÈÇÅÁöÑÊúâÊ©üËæ≤Â†¥È§êÂª≥„ÄÇ", desc_2: "ÊãõÁâåËèúÔºöÁÇ∏Ë±¨ÁöÆ„ÄÅÊ≥∞ÂåóÂíñÂì©È∫µ„ÄÇ", location: "Ginger Farm Kitchen Pattaya", thai_text: "‡∏£‡πâ‡∏≤‡∏ô‡∏à‡∏¥‡∏ô‡πÄ‡∏à‡∏≠‡∏£‡πå ‡∏ü‡∏≤‡∏£‡πå‡∏° ‡∏Ñ‡∏¥‡∏ó‡πÄ‡∏ä‡πà‡∏ô" },
                { id: "e5", time: "21:30", title: "Makkah Spa", desc: "ËàíÁ∑©È£õË°åÁñ≤Âãû„ÄÇ", type: "spa", img: "https://images.unsplash.com/photo-1544161515-4ab6ce6db874?w=800", gallery: IG_GALLERY, desc_1: "Áí∞Â¢ÉÊ∏ÖÂπΩÔºåÊúçÂãôË¶™Âàá„ÄÇ", desc_2: "Âª∫Ë≠∞È†êÁ¥ÑÔºöÊ≥∞ÂºèÂÇ≥Áµ±ÊåâÊë© 90ÂàÜÈêò„ÄÇ", location: "Makkah Health & Spa Pattaya", thai_text: "‡∏°‡∏±‡∏Ñ‡∏Ñ‡∏≤ ‡πÄ‡∏Æ‡∏•‡∏ó‡πå ‡πÅ‡∏≠‡∏ô‡∏î‡πå ‡∏™‡∏õ‡∏≤" }
            ]},
            { day: "Day 2", date: "2/14", weekday: "(ÂÖ≠)", theme: "„ÄåÊ≥∞„ÄçÁßëÂπª", id: "d2", highlights: "ÊòüÈöõÊé¢Èö™‰πãÊóÖ", details: [
                { id: "e6", time: "11:00", title: "ÂæÄ Space Hotel", desc: "ÂÖ•‰ΩèÂÖ®Ê≥∞È¶ñÂ∫ßÂ§™Á©∫ÈÖíÂ∫ó„ÄÇ", type: "hotel", img: "https://images.unsplash.com/photo-1571896349842-6e5c48dc52e3?w=800", gallery: IG_GALLERY, desc_1: "Â§ßÂª≥Êúâ‰∫íÂãïÈÅäÊà≤ÂçÄ„ÄÇ", desc_2: "ÊàøÈñìÂÖßÊúâÊ•µÂÖâÊäïÂΩ±„ÄÇ", location: "Grande Centre Point Space Pattaya", thai_text: "‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏° ‡πÅ‡∏Å‡∏£‡∏ô‡∏î‡πå ‡πÄ‡∏ã‡∏ô‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡∏û‡∏≠‡∏¢‡∏ï‡πå ‡∏™‡πÄ‡∏õ‡∏ã ‡∏û‡∏±‡∏ó‡∏¢‡∏≤" },
                { id: "e7", time: "12:00", title: "Tora Tapas", desc: "Á≤æÁ∑ªÊ≥∞Ë•øÂêàÁíßÊñôÁêÜ„ÄÇ", type: "food", img: "https://images.unsplash.com/photo-1514326640560-7d063ef2aed5?w=800", gallery: IG_GALLERY, desc_1: "Êó•ÂºèËàáË•øÁè≠ÁâôÈ¢®Ê†ºÁµêÂêà„ÄÇ", desc_2: "ÂçàÈ§êÂ•óÈ§êÊÄßÂÉπÊØîÈ´ò„ÄÇ", location: "Tora Tapas Pattaya", thai_text: "‡πÇ‡∏ó‡∏£‡∏≤ ‡∏ó‡∏≤‡∏õ‡∏≤‡∏™ ‡∏û‡∏±‡∏ó‡∏¢‡∏≤" },
                { id: "e8", time: "14:00", title: "Space Ê∞¥‰∏äÊ®ÇÂúí", desc: "ÊåëÊà∞ÊªëÊ∞¥ÈÅìËàá‰∫∫ÈÄ†Êµ™„ÄÇ", type: "activity", img: "https://images.unsplash.com/photo-1533316447883-492770977218?w=800", gallery: IG_GALLERY, desc_1: "ÂÉÖÈôê‰ΩèÂÆ¢‰ΩøÁî®Ôºå‰∫∫ÊΩÆËºÉÂ∞ë„ÄÇ", desc_2: "Ë®òÂæóÂ∏∂Èò≤Êõ¨ËàáÈò≤Ê∞¥Ë¢ã„ÄÇ", location: "Grande Centre Point Space Pattaya", thai_text: "‡∏™‡∏ß‡∏ô‡∏ô‡πâ‡∏≥‡∏≠‡∏ß‡∏Å‡∏≤‡∏®" },
                { id: "e9", time: "19:00", title: "Orbit Ëá™Âä©È§ê", desc: "Êµ∑ÈÆÆÁîüË†î‰ªªÈ£ü„ÄÇ", type: "food", img: "https://images.unsplash.com/photo-1625937751876-453009747972?w=800", gallery: IG_GALLERY, desc_1: "ÈÖíÂ∫óÂÖßÈ§êÂª≥ÔºåÊñπ‰æøËàíÈÅ©„ÄÇ", desc_2: "ÁîúÈªûÂçÄÈùûÂ∏∏Ë±êÂØå„ÄÇ", location: "Grande Centre Point Space Pattaya", thai_text: "‡∏´‡πâ‡∏≠‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏≠‡∏£‡πå‡∏ö‡∏¥‡∏ó" }
            ]},
            { day: "Day 3", date: "2/15", weekday: "(Êó•)", theme: "„ÄåÊ≥∞„ÄçÁÜ±Ë°Ä", id: "d3", highlights: "Êú®ÈõïËàáË∂äÈáé", details: [
                { id: "e10", time: "10:30", title: "ÁúüÁêÜËÅñÊÆø", desc: "ÂÖ®Êú®ÈÄ†Âª∫ÁØâÂ•áËπü„ÄÇ", type: "activity", img: "https://images.unsplash.com/photo-1599553765870-07a828cb0085?w=800", gallery: IG_GALLERY, desc_1: "ÁÑ°ÈáòÂ≠êÂª∫ÈÄ†ÔºåÂ∑•ËóùÁ≤æÊπõ„ÄÇ", desc_2: "ÊúâÈ®éÂ§ßË±°ËàáÈÅäËàπÊ¥ªÂãï„ÄÇ", location: "Sanctuary of Truth", thai_text: "‡∏õ‡∏£‡∏≤‡∏™‡∏≤‡∏ó‡∏™‡∏±‡∏à‡∏ò‡∏£‡∏£‡∏°" },
                { id: "e11", time: "13:00", title: "ATV Ë∂äÈáéÈ£õËªä", desc: "Á©øË∂äÂè¢ÊûóÔºåÁÜ±Ë°ÄÊ≤∏È®∞„ÄÇ", type: "activity", img: "https://images.unsplash.com/photo-1551816230-ef5deaed4a26?w=800", gallery: IG_GALLERY, desc_1: "ÂÖ®Á®ãÁ¥Ñ2Â∞èÊôÇÔºåÂåÖÂê´ÊïôÂ≠∏„ÄÇ", desc_2: "Âª∫Ë≠∞Á©øËëó‰∏çÊÄïÈ´íÁöÑË°£Áâ©„ÄÇ", location: "Pattaya Offroad Safari", thai_text: "‡∏û‡∏±‡∏ó‡∏¢‡∏≤ ‡∏≠‡∏≠‡∏ü‡πÇ‡∏£‡∏î ‡∏ã‡∏≤‡∏ü‡∏≤‡∏£‡∏µ" },
                { id: "e12", time: "18:30", title: "Bay Bay Seafood", desc: "Êµ∑Êø± BBQ ÁõõÂÆ¥„ÄÇ", type: "food", img: "https://images.unsplash.com/photo-1534008753122-a837cf46d288?w=800", gallery: IG_GALLERY, desc_1: "Êñ∞ÈÆÆÊµ∑ÈÆÆÁèæÈªûÁèæÁÉ§„ÄÇ", desc_2: "Èú≤Â§©Â∫ß‰ΩçÊ∞£Ê∞õ‰Ω≥„ÄÇ", location: "BayBay Buffet Talaypao", thai_text: "‡πÄ‡∏ö‡∏¢‡πå‡πÄ‡∏ö‡∏¢‡πå ‡∏ö‡∏∏‡∏ü‡πÄ‡∏ü‡∏ï‡πå‡∏ó‡∏∞‡πÄ‡∏•‡πÄ‡∏ú‡∏≤" },
                { id: "e13", time: "20:30", title: "‰∏≠Â§©Â§úÂ∏Ç", desc: "Êï£Ê≠•ÂêÉÂÆµÂ§ú„ÄÇ", type: "activity", img: "https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=800", gallery: IG_GALLERY, desc_1: "ÊØîÂ∏ÇÂçÄÂ§úÂ∏ÇÊõ¥ÊÇ†Èñí„ÄÇ", desc_2: "Ê∞¥ÊûúËàáÊâãÂ∑•ËóùÂìÅ‰æøÂÆú„ÄÇ", location: "Jomtien Night Market", thai_text: "‡∏ï‡∏•‡∏≤‡∏î‡∏ô‡∏±‡∏î‡∏à‡∏≠‡∏°‡πÄ‡∏ó‡∏µ‡∏¢‡∏ô" }
            ]},
            { day: "Day 4", date: "2/16", weekday: "(‰∏Ä)", theme: "„ÄåÊ≥∞„ÄçÊãõÁ©ç", id: "d4", highlights: "ÁßÅ‰∫∫ÂåÖËàπ", details: [
                { id: "e14", time: "10:30", title: "ÂæÄ Villa", desc: "‰∫∫Ë≤®ÂàÜÊµÅÔºåË°åÊùéÂÖàË°å„ÄÇ", type: "transport", img: "https://images.unsplash.com/photo-1580587771525-78b9dba3b91d?w=800", gallery: IG_GALLERY, desc_1: "Êõ¥Êèõ‰ΩèÂÆøËá≥ÁßÅ‰∫∫Âà•Â¢Ö„ÄÇ", desc_2: "ÁÆ°ÂÆ∂ÂçîÂä©ËôïÁêÜË°åÊùé„ÄÇ", location: "Villa De Amore Pattaya", thai_text: "‡∏ß‡∏¥‡∏•‡∏•‡πà‡∏≤ ‡πÄ‡∏î‡∏≠ ‡∏≠‡∏∞‡∏°‡∏≠‡πÄ‡∏£‡πà ‡∏û‡∏±‡∏ó‡∏¢‡∏≤" },
                { id: "e15", time: "11:30", title: "ÂâçÂæÄÁ¢ºÈ†≠", desc: "Ê∫ñÂÇôÂá∫Êµ∑ÔºÅ", type: "transport", img: "https://images.unsplash.com/photo-1569263979104-565b63418962?w=800", gallery: IG_GALLERY, desc_1: "ËªäÁ®ãÁ¥Ñ1Â∞èÊôÇ„ÄÇ", desc_2: "Á¢ºÈ†≠Êúâ‰æøÂà©ÂïÜÂ∫óÂèØË£úÁµ¶„ÄÇ", location: "Port of Samae Sarn", thai_text: "‡∏ó‡πà‡∏≤‡πÄ‡∏£‡∏∑‡∏≠‡πÅ‡∏™‡∏°‡∏™‡∏≤‡∏£" },
                { id: "e16", time: "13:00", title: "Sealyn ÁßÅ‰∫∫ÂåÖËàπ", desc: "Ë±™ËèØÈõôÂ±§ËàπÔºåÊªëÊ¢Ø„ÄÅÁç®Êú®Ëàü„ÄÇ", type: "activity", img: "https://images.unsplash.com/photo-1544644181-1484b3fdfc62?w=800", gallery: IG_GALLERY, desc_1: "ÂåÖÂê´Ëàπ‰∏äÂçàÈ§êËàáÈ£≤Êñô„ÄÇ", desc_2: "ÂèØÈ´îÈ©óÊµ∑Èá£ËàáÊµÆÊΩõ„ÄÇ", location: "Samae San Island", thai_text: "‡πÄ‡∏´‡∏°‡∏≤‡πÄ‡∏£‡∏∑‡∏≠‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß Seanlyn" },
                { id: "e17", time: "17:30", title: "Villa De Amore", desc: "ÂÖ•‰ΩèÁßÅ‰∫∫Ê≥≥Ê±†Âà•Â¢Ö„ÄÇ", type: "hotel", img: "https://images.unsplash.com/photo-1613490493576-7fde63acd811?w=800", gallery: IG_GALLERY, desc_1: "9‰∫∫ÂåÖÊ£üÔºåË®≠ÊñΩÈΩäÂÖ®„ÄÇ", desc_2: "Êôö‰∏äÂèØÂî±KTVÊàñÊ∏∏Ê≥≥„ÄÇ", location: "Villa De Amore Pattaya", thai_text: "‡∏ß‡∏¥‡∏•‡∏•‡πà‡∏≤ ‡πÄ‡∏î‡∏≠ ‡∏≠‡∏∞‡∏°‡∏≠‡πÄ‡∏£‡πà" }
            ]},
            { day: "Day 5", date: "2/17", weekday: "(‰∫å)", theme: "„ÄåÊ≥∞„ÄçÁ∂≤Á¥Ö", id: "d5", highlights: "È£üÁ•ûÊó•ËêΩ", details: [
                { id: "e18", time: "11:30", title: "Khun Sri Ë±¨Èõú", desc: "80Âπ¥ËÄÅÂ∫ó„ÄÇ", type: "food", img: "https://images.unsplash.com/photo-1548943487-a2e4e43b485c?w=800", gallery: IG_GALLERY, desc_1: "ÊπØÈ†≠ÊøÉÈÉÅÔºåÊñôÂ§öÂØ¶Âú®„ÄÇ", desc_2: "ÂøÖÈªûËÑÜÁöÆÁáíËÇâ„ÄÇ", location: "Khun Sri Pork Blood Soup", thai_text: "‡∏ï‡πâ‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏´‡∏°‡∏π‡∏Ñ‡∏∏‡∏ì‡∏®‡∏£‡∏µ" },
                { id: "e19", time: "13:00", title: "After Yum", desc: "ÂÖ®Ê≥∞ÊúÄÁ¥ÖÁîüÈÜÉ„ÄÇ", type: "food", img: "https://images.unsplash.com/photo-1626804475297-411d0c624f9c?w=800", gallery: IG_GALLERY, desc_1: "Á∂≤Á¥ÖÊéíÈöäÂêçÂ∫ó„ÄÇ", desc_2: "ÁîüÈÜÉÈÆ≠È≠ö„ÄÅËóçËüπÂøÖÂêÉ„ÄÇ", location: "After Yum", thai_text: "‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏ü‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏¢‡∏≥" },
                { id: "e20", time: "15:00", title: "Ê∞¥‰∏äÂ∏ÇÂ†¥", desc: "È´îÈ©óÊâãÂàíËàπ„ÄÇ", type: "activity", img: "https://images.unsplash.com/photo-1598970434795-0c54fe7c0648?w=800", gallery: IG_GALLERY, desc_1: "ÊÑüÂèóÊ≥∞ÂúãÂÇ≥Áµ±Ê∞¥‰∏äÁîüÊ¥ª„ÄÇ", desc_2: "ÂèØË≥ºË≤∑ÁâπËâ≤Á¥ÄÂøµÂìÅ„ÄÇ", location: "Pattaya Floating Market", thai_text: "‡∏ï‡∏•‡∏≤‡∏î‡∏ô‡πâ‡∏≥ 4 ‡∏†‡∏≤‡∏Ñ ‡∏û‡∏±‡∏ó‡∏¢‡∏≤" },
                { id: "e21", time: "16:30", title: "House of Benedict", desc: "Ë∂ÖÂ•ΩÊãçÁ∂≤Á¥ÖÈªû„ÄÇ", type: "activity", img: "https://images.unsplash.com/photo-1554118811-1e0d58224f24?w=800", gallery: IG_GALLERY, desc_1: "Â§öÁ®ÆÈ¢®Ê†ºÊîùÂΩ±Ê£ö„ÄÇ", desc_2: "ÈÅ©ÂêàÊãçÁÖßÊâìÂç°„ÄÇ", location: "House of Benedict Pattaya", thai_text: "‡πÄ‡∏Æ‡∏≤‡∏™‡πå ‡∏≠‡∏≠‡∏ü ‡πÄ‡∏ö‡πÄ‡∏ô‡∏î‡∏¥‡∏Å‡∏ï‡πå" },
                { id: "e22", time: "18:00", title: "Glass House", desc: "Êó•ËêΩÊµ∑ÈÆÆÈ§ê„ÄÇ", type: "food", img: "https://images.unsplash.com/photo-1537047902294-6228b02e6993?w=800", gallery: IG_GALLERY, desc_1: "Ê≤ôÁÅòÂ∫ß‰ΩçÔºåÊ∞£Ê∞õÊµ™Êº´„ÄÇ", desc_2: "ÈÅ©ÂêàÊ¨£Ë≥ûÂ§ïÈôΩ„ÄÇ", location: "The Glass House Boho", thai_text: "‡πÄ‡∏î‡∏≠‡∏∞ ‡∏Å‡∏•‡∏≤‡∏™‡πÄ‡∏Æ‡πâ‡∏≤‡∏™‡πå ‡πÇ‡∏ö‡πÇ‡∏Æ" },
                { id: "e23", time: "21:00", title: "Oasis Spa", desc: "È´òÁ¥öÊåâÊë©„ÄÇ", type: "spa", img: "https://images.unsplash.com/photo-1519823551278-64ac92734fb1?w=800", gallery: IG_GALLERY, desc_1: "ÊúçÂãôËàáÁí∞Â¢ÉÁöÜÁÇ∫È†ÇÁ¥ö„ÄÇ", desc_2: "ÂæπÂ∫ïÊîæÈ¨ÜË∫´ÂøÉ„ÄÇ", location: "Oasis Spa Pattaya Jomtien", thai_text: "‡πÇ‡∏≠‡πÄ‡∏≠‡∏ã‡∏¥‡∏™ ‡∏™‡∏õ‡∏≤ ‡∏û‡∏±‡∏ó‡∏¢‡∏≤" }
            ]},
            { day: "Day 6", date: "2/18", weekday: "(‰∏â)", theme: "„ÄåÊ≥∞„ÄçÂîîÊç®Âæó", id: "d6", highlights: "ÊúÄÂæåË°ùÂà∫", details: [
                { id: "e24", time: "11:00", title: "Villa ÈÄÄÊàø", desc: "Êî∂ÊãæÂøÉÊÉÖ„ÄÇ", type: "hotel", img: "https://images.unsplash.com/photo-1566073771259-6a8506099945?w=800", gallery: IG_GALLERY, desc_1: "Ê™¢Êü•Ë°åÊùéÊòØÂê¶ÈÅ∫Êºè„ÄÇ", desc_2: "ËàáÂà•Â¢ÖÂêàÂΩ±ÁïôÂøµ„ÄÇ", location: "Villa De Amore Pattaya", thai_text: "‡∏ß‡∏¥‡∏•‡∏•‡πà‡∏≤ ‡πÄ‡∏î‡∏≠ ‡∏≠‡∏∞‡∏°‡∏≠‡πÄ‡∏£‡πà" },
                { id: "e25", time: "11:30", title: "Lek Seafood", desc: "ÊúÄÂæåÊµ∑ÈÆÆ„ÄÇ", type: "food", img: "https://images.unsplash.com/photo-1599488615731-7e512819a636?w=800", gallery: IG_GALLERY, desc_1: "Âú®Âú∞‰∫∫Êé®Ëñ¶Âπ≥ÂÉπÊµ∑ÈÆÆ„ÄÇ", desc_2: "ÂíñÂì©Ëüπ„ÄÅËí∏È≠öÂøÖÈªû„ÄÇ", location: "Lek Seafood", thai_text: "‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏•‡πá‡∏Å‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏∞‡πÄ‡∏•" },
                { id: "e26", time: "13:15", title: "ÂæÄÊ©üÂ†¥", desc: "Â∞àËªäÁõ¥ÈÄÅ BKK„ÄÇ", type: "transport", img: "https://images.unsplash.com/photo-1530521954074-e64f6810b32d?w=800", gallery: IG_GALLERY, desc_1: "È†êË®àËªäÁ®ã1.5-2Â∞èÊôÇ„ÄÇ", desc_2: "Ê∫ñÂÇôÊê≠Ê©üËøîÊ∏Ø„ÄÇ", location: "Suvarnabhumi Airport", thai_text: "‡∏™‡∏ô‡∏≤‡∏°‡∏ö‡∏¥‡∏ô‡∏™‡∏∏‡∏ß‡∏£‡∏£‡∏ì‡∏†‡∏π‡∏°‡∏¥" }
            ]}
        ];

        const GUIDE_ITEMS = [
            { id: 1, category: "Áé©Ê®Ç", name: "Sealyn ÂåÖËàπ", tag: "Ë±™ËèØÈï∑Â∞æËàπ", desc_1: "È´îÈ©óËä≠Â†§ÈõÖÊúÄÂ•¢ËèØÁöÑÁßÅ‰∫∫Êµ∑‰∏äÊ¥æÂ∞çÔºÅÈÄôËâòÈõôÂ±§Ë±™ËèØÈï∑Â∞æËàπ‰∏çÂÉÖÂ§ñÂûãÂæ©Âè§Âê∏ÁùõÔºåË®≠ÊñΩÊõ¥ÊòØÊáâÊúâÁõ°Êúâ„ÄÇ", desc_2: "ËàπÂì°ÊúÉË≤ºÂøÉÊ∫ñÂÇôÈá£ÂÖ∑ËÆì‰Ω†È´îÈ©óÊµ∑Èá£Ê®ÇË∂£ÔºåÈá£Âà∞ÁöÑÈ≠öÈÇÑËÉΩÁèæÂ†¥Âä†Ëèú„ÄÇÊúÄÊ£íÁöÑÊòØËàπ‰∏äÊèê‰æõÁöÑ BBQ ÂçàÈ§ê„ÄÇ", gallery1: ["https://images.unsplash.com/photo-1544551763-46a8723ba3f9?w=600"], gallery2: [], cover: "https://images.unsplash.com/photo-1544644181-1484b3fdfc62?w=600&q=80", video: "M7lc1UVf-VE" },
            { id: 4, category: "ÁæéÈ£ü", name: "After Yum", tag: "ÁîüÈÜÉÂÇ≥Â•á", desc_1: "Ê≤íÂêÉÈÅé After Yum Â∞±‰∏çÁÆó‰æÜÈÅéËä≠Â†§ÈõÖÔºÅÈÄôÂÆ∂Â∫óÊòØÊ≥∞ÂúãÁîüÈÜÉÁïåÁöÑÈ†ÇÊµÅ„ÄÇ", desc_2: "ÈÜ¨Ê±ÅÈÖ∏Ëæ£ÈÆÆÁîúÊØî‰æãÂÆåÁæéÔºåÂÆåÂÖ®Ê≤íÊúâËÖ•Âë≥„ÄÇÂøÖÈªûÁîüÈÜÉ‰∏âÊñáÈ≠öÔºåÂéöÂàáËÇ•ÁæéÔºõÈÖ∏Ëæ£ÁîüËù¶Âè£ÊÑüÂΩàÁâô„ÄÇ", gallery1: ["https://images.unsplash.com/photo-1626804475297-411d0c624f9c?w=600"], gallery2: ["https://images.unsplash.com/photo-1559339352-11d035aa65de?w=600"], cover: "https://images.unsplash.com/photo-1559339352-11d035aa65de?w=600&q=80" },
            { id: 15, category: "Ë≥ºÁâ©", name: "ÂøÖË≤∑Ê∏ÖÂñÆ", tag: "Êâã‰ø°Êé®Ëñ¶", desc_1: "Ê≥∞Âúã 7-11 ÁÜ±Â£ìÂêêÂè∏„ÄÅPocky È¶ôËïâÂè£Âë≥„ÄÅÊâãÊ®ôÊ≥∞ÂºèËå∂Á≤â„ÄÇ", desc_2: "Big C Ë∂ÖÂ∏ÇÂèØ‰ª•Ë≤∑Âà∞ÂêÑÁ®ÆÈõ∂È£üÔºåÊé®Ëñ¶Â∞èËÄÅÈóÜÊµ∑ËãîËàáËäíÊûú‰πæ„ÄÇ", gallery1: ["https://images.unsplash.com/photo-1583209814683-c023dd293cc6?w=600"], gallery2: [], cover: "https://images.unsplash.com/photo-1583209814683-c023dd293cc6?w=600&q=80" },
            { id: 3, category: "‰ΩèÂÆø", name: "Space Pattaya", tag: "ÁßëÂπªÊú™‰æÜ", desc_1: "ÂÖ®Ê≥∞È¶ñÂ∫ß...", desc_2: "ÊàøÈñìÂ§©Ëä±Êùø...", gallery1: ["https://images.unsplash.com/photo-1571896349842-6e5c48dc52e3?w=600"], gallery2: [], cover: "https://images.unsplash.com/photo-1571896349842-6e5c48dc52e3?w=600&q=80" },
            { id: 5, category: "ÁæéÈ£ü", name: "Glass House Boho", tag: "Êó•ËêΩÊôöÈ§ê", desc_1: "Ê≥¢Â∏åÁ±≥‰∫û...", desc_2: "ÂêÉÈ£ΩÂæå...", gallery1: ["https://images.unsplash.com/photo-1537047902294-6228b02e6993?w=600"], gallery2: [], cover: "https://images.unsplash.com/photo-1537047902294-6228b02e6993?w=600&q=80" },
            { id: 6, category: "‰ΩèÂÆø", name: "Villa De Amore", tag: "ÁßÅ‰∫∫Èö±‰∏ñ", desc_1: "9‰∫∫ÂÆ∂Â∫≠Â∞àÂ±¨ÂåÖÂ†¥...", desc_2: "ÂÆ¢Âª≥ÊåëÈ´òÂØ¨Êïû...", gallery1: ["https://images.unsplash.com/photo-1580587771525-78b9dba3b91d?w=600"], gallery2: [], cover: "https://images.unsplash.com/photo-1580587771525-78b9dba3b91d?w=600&q=80" },
            { id: 7, category: "‰ΩèÂÆø", name: "Akara Hotel", tag: "ÈÉΩÊúÉËºïÂ•¢", desc_1: "È†ÇÊ®ìÁÑ°ÈÇäÈöõÊ≥≥Ê±†...", desc_2: "ÊàøÈñìË®≠Ë®àÁèæ‰ª£ÊôÇÂ∞ö...", gallery1: ["https://images.unsplash.com/photo-1566073771259-6a8506099945?w=600"], gallery2: [], cover: "https://images.unsplash.com/photo-1566073771259-6a8506099945?w=600&q=80" },
            { id: 2, category: "Áé©Ê®Ç", name: "ATV Ë∂äÈáéËªä", tag: "ÁÜ±Ë°ÄÂÜíÈö™", desc_1: "Á©øË∂äÂè¢ÊûóÊ≥•Âú∞...", desc_2: "Ë∑üÈö®Â∞àÊ•≠ÊïôÁ∑¥...", gallery1: ["https://images.unsplash.com/photo-1551816230-ef5deaed4a26?w=600"], gallery2: [], cover: "https://images.unsplash.com/photo-1551816230-ef5deaed4a26?w=600&q=80" },
            { id: 8, category: "ÁæéÈ£ü", name: "Ginger Farm", tag: "Ê≥∞ÂåóÈ¢®Âë≥", desc_1: "‰æÜËá™Ê∏ÖÈÇÅÁöÑÁ±≥ËäùËìÆÊé®Ëñ¶È§êÂª≥...", desc_2: "ÂøÖÈªûÁÇ∏Ë±¨ÁöÆ...", gallery1: ["https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=600"], gallery2: [], cover: "https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=600&q=80" },
            { id: 9, category: "Áé©Ê®Ç", name: "Makkah Spa", tag: "ËàíÁ∑©ÊîæÈ¨Ü", desc_1: "Áí∞Â¢ÉÊ∏ÖÂπΩÂÖ∏ÈõÖ...", desc_2: "Á¨¨‰∏ÄÂ§©ËàüËªäÂãûÈ†ì...", gallery1: ["https://images.unsplash.com/photo-1544161515-4ab6ce6db874?w=600"], gallery2: [], cover: "https://images.unsplash.com/photo-1544161515-4ab6ce6db874?w=600&q=80" },
            { id: 10, category: "ÁæéÈ£ü", name: "Tora Tapas", tag: "Á≤æÁ∑ªÊñôÁêÜ", desc_1: "ÁµêÂêàÊ≥∞ÂºèÈ¢®Âë≥...", desc_2: "ÂçàÈ§êÊôÇÈñì...", gallery1: ["https://images.unsplash.com/photo-1514326640560-7d063ef2aed5?w=600"], gallery2: [], cover: "https://images.unsplash.com/photo-1514326640560-7d063ef2aed5?w=600&q=80" },
            { id: 11, category: "ÁæéÈ£ü", name: "Orbit Restaurant", tag: "Êµ∑ÈÆÆËá™Âä©", desc_1: "È£ØÂ∫óÈ†ÇÁ¥öÊµ∑ÈÆÆ Buffet...", desc_2: "ÊôöÈ§êÂ∞±Âú®È£ØÂ∫óÂÖß...", gallery1: ["https://images.unsplash.com/photo-1625937751876-453009747972?w=600"], gallery2: [], cover: "https://images.unsplash.com/photo-1625937751876-453009747972?w=600&q=80" },
            { id: 12, category: "Áé©Ê®Ç", name: "ÁúüÁêÜËÅñÊÆø", tag: "Êú®ÈõïËóùË°ì", desc_1: "ÂÖ®Êú®ÈÄ†ÁµêÊßã‰∏çÂê´‰∏ÄÈ°ÜÈáòÂ≠ê...", desc_2: "Èô§‰∫ÜÂèÉËßÄ...", gallery1: ["https://images.unsplash.com/photo-1599553765870-07a828cb0085?w=600"], gallery2: [], cover: "https://images.unsplash.com/photo-1599553765870-07a828cb0085?w=600&q=80" },
            { id: 13, category: "ÁæéÈ£ü", name: "Bay Bay Seafood", tag: "Êµ∑ÈÆÆBBQ", desc_1: "Èú≤Â§©Êµ∑ÊôØ...", desc_2: "ÊôöÈ§ê‰æÜÂà∞‰∏≠Â§©Êµ∑Êø±...", gallery1: ["https://images.unsplash.com/photo-1534008753122-a837cf46d288?w=600"], gallery2: [], cover: "https://images.unsplash.com/photo-1534008753122-a837cf46d288?w=600&q=80" },
            { id: 14, category: "Áé©Ê®Ç", name: "Jomtien Market", tag: "Âú∞ÈÅìÂ§úÂ∏Ç", desc_1: "Ê≤øËëóÊµ∑Êø±Êï£Ê≠•...", desc_2: "ÂêÉÈ£ΩÂæåÊï£Ê≠•...", gallery1: ["https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=600"], gallery2: [], cover: "https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=600&q=80" }
        ];

        /* --- 2. Components --- */
        const Icon = ({ name, size = 20, className }) => {
            useEffect(() => { lucide.createIcons(); }, [name]);
            return <i data-lucide={name} style={{ width: size, height: size }} className={className}></i>;
        };

        const HeroHeader = () => (
            <div className="relative h-[220px] w-full overflow-hidden bg-white z-0 flex flex-col justify-end pb-4 items-center">
                <img src="https://images.unsplash.com/photo-1595661665673-9a3d4d385226?w=800&q=80" className="absolute inset-0 w-full h-full object-cover opacity-90" />
                <div className="absolute inset-0 bg-gradient-to-t from-bg to-transparent"></div>
                <div className="relative z-10 text-center mb-1">
                    <h1 className="font-serif text-3xl text-dark font-bold tracking-wide leading-tight shadow-sm text-center">Ê≥∞ÂòÜËä≠Â†§ÈõÖ</h1>
                    <div className="text-gray-500 text-xs font-bold mt-1 tracking-wider text-center">Êñ∞Âπ¥Â∫¶ÂÅáÂúò</div>
                </div>
            </div>
        );

        const FloatingTopNav = ({ activeDay, scrollTo, onMenuClick }) => {
            const dayTabs = ITINERARY.map((day, i) => ({ id: day.id, label: day.date, weekday: day.weekday, dayNum: `Day ${i+1}` }));
            return (
                <div className="sticky-nav-container">
                    <div className="menu-btn-wrapper" onClick={onMenuClick}>
                         <Icon name="menu" size={24} className="text-primary" />
                    </div>
                    <div className="day-tabs-wrapper no-scrollbar">
                        {dayTabs.map((tab) => (
                            <button key={tab.id} onClick={() => scrollTo(tab.id)} className={`day-pill ${activeDay === tab.id ? 'active' : ''}`}>
                                <span className="text-[10px] font-bold leading-tight">{tab.label}</span>
                                <span className="text-[8px] opacity-80 leading-tight">{tab.weekday}</span>
                                <span className="text-[9px] font-black mt-0.5">{tab.dayNum}</span>
                            </button>
                        ))}
                    </div>
                </div>
            );
        };

        const MenuDropdown = ({ user, scrollTo, onClose, onSwitchUser, isOpen }) => {
            const [isUserOpen, setIsUserOpen] = useState(false);
            const menuItems = [ { id: 'timeline', icon: 'calendar', label: 'Ë°åÁ®ã' }, { id: 'guide', icon: 'compass', label: 'Ë≥áË®ä' }, { id: 'wallet', icon: 'wallet', label: 'Ë®òÂ∏≥' }, { id: 'tools', icon: 'wrench', label: 'Â∑•ÂÖ∑' }, { id: 'memory', icon: 'image', label: 'Áõ∏Á∞ø' } ];
            
            if (!isOpen) return null;

            return (
                <div className="menu-dropdown">
                    <div className="flex flex-col items-center gap-1 p-2 border-b border-gray-200/50 mb-1 cursor-pointer hover:bg-gray-100 rounded-xl w-full" onClick={() => setIsUserOpen(!isUserOpen)}>
                        <div className="w-8 h-8 rounded-full bg-primary/20 flex items-center justify-center text-sm">{user.avatar}</div>
                        <span className="text-[10px] font-bold text-gray-500 truncate w-full text-center">{user.name}</span>
                    </div>
                    
                    {isUserOpen && (
                        <div className="user-popout">
                            <div className="flex gap-2 overflow-x-auto p-1 no-scrollbar">
                                {MEMBERS.map(m => (
                                    <div key={m.id} className="flex flex-col items-center flex-shrink-0 cursor-pointer p-1 hover:bg-gray-100 rounded-lg" onClick={() => { onSwitchUser(m); setIsUserOpen(false); }}>
                                        <div className="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center">{m.avatar}</div>
                                        <span className="text-[8px] font-bold mt-1">{m.name}</span>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}

                    {menuItems.map(item => (
                        <div key={item.id} onClick={() => { scrollTo(item.id); onClose(); }} className="menu-item w-full justify-center">
                            <Icon name={item.icon} size={18} /><span className="text-[10px]">{item.label}</span>
                        </div>
                    ))}
                </div>
            );
        };

        /* --- Expense Modules --- */
        const useExchangeRates = () => {
             const [rates, setRates] = useState(null);
             useEffect(() => {
                 const saved = JSON.parse(localStorage.getItem("exchange_rates"));
                 const today = new Date().toDateString();
                 if (saved && saved.date === today) { setRates(saved.rates); return; }
                 fetch("https://open.er-api.com/v6/latest/THB")
                    .then(res => res.json())
                    .then(data => {
                        const filtered = {};
                        ["THB", "HKD", "TWD", "JPY", "CNY", "USD"].forEach(c => filtered[c] = data.rates[c]);
                        localStorage.setItem("exchange_rates", JSON.stringify({ date: today, rates: filtered }));
                        setRates(filtered);
                    })
                    .catch(() => {
                        if (saved) setRates(saved.rates);
                        else setRates({ THB: 1, HKD: 0.22, TWD: 0.9, JPY: 4.2, CNY: 0.2, USD: 0.028 });
                    });
             }, []);
             return rates;
        };

        const ExpenseModule = ({ user }) => {
            const [expenseMode, setExpenseMode] = useState(null);
            const [expenses, setExpenses] = useState([{ id: 1, item: "ËªäË≤ª", cost: 400, inputCurrency: "HKD", baseAmount: 1800, payer: "lam", splitters: MEMBERS.map(m => m.id), type: "public", category: "‰∫§ÈÄö" }]);
            const [item, setItem] = useState("");
            const [cost, setCost] = useState("");
            const [currency, setCurrency] = useState("THB");
            const [payer, setPayer] = useState(user.id);
            const [splitters, setSplitters] = useState(MEMBERS.filter(m => m.id !== 'han').map(m => m.id)); // È†êË®≠ÊéíÈô§ Han
            const [showHistoryModal, setShowHistoryModal] = useState(false);
            const [historyFilter, setHistoryFilter] = useState('ALL');
            const [historySort, setHistorySort] = useState('DATE');
            const exchangeRates = useExchangeRates();
            const [isBalancesExpanded, setIsBalancesExpanded] = useState(false);

            // ÂåØÁéáË®àÁÆóÔºöTHB ÁÇ∫Âü∫Ê∫ñ (Rate = 1/ExchangeRate)
            const toBaseAmount = (amt, curr) => {
                if (!exchangeRates) return amt;
                return amt * (1 / exchangeRates[curr]);
            };

            const autoCategorize = (txt) => {
                if (txt.match(/Ëªä|Grab|Bolt|Taxi/i)) return "‰∫§ÈÄö";
                if (txt.match(/È£ü|È£Ø|È∫µ|È§ê|Ê∞¥/i)) return "È£≤È£ü";
                if (txt.match(/Ë≤∑|7-11|Big C/i)) return "Ë≥ºÁâ©";
                return "ÈõúÈ†Ö";
            }

            const addExpense = () => {
                if (!item || !cost) return;
                const cat = autoCategorize(item);
                const baseAmt = toBaseAmount(parseFloat(cost), currency);
                const newExp = { 
                    id: Date.now(), item, cost: parseFloat(cost), inputCurrency: currency, baseAmount: baseAmt,
                    payer: expenseMode === 'public' ? payer : user.id, 
                    splitters: expenseMode === 'public' ? splitters : [user.id], 
                    type: expenseMode, category: cat 
                };
                setExpenses(prev => [newExp, ...prev]);
                setItem(""); setCost(""); setExpenseMode(null);
            };

            const toggleSplitter = (id) => { if (splitters.includes(id)) setSplitters(splitters.filter(s => s !== id)); else setSplitters([...splitters, id]); };
            const toggleAll = () => { setSplitters(splitters.length === MEMBERS.length - 1 ? [] : MEMBERS.filter(m => m.id !== 'han').map(m=>m.id)); };
            const deleteExpense = (id) => setExpenses(expenses.filter(e => e.id !== id));

            const balances = {};
            MEMBERS.forEach(m => balances[m.id] = 0);
            expenses.filter(e => e.type === 'public').forEach(e => {
                const amount = e.baseAmount;
                const share = amount / e.splitters.length;
                balances[e.payer] += amount;
                e.splitters.forEach(id => balances[id] -= share);
            });
            const myBal = balances[user.id];

            const publicTotal = expenses.reduce((acc, c) => acc + (c.type === 'public' ? c.baseAmount : 0), 0);
            const privateTotal = expenses.reduce((acc, c) => {
                if (c.type === 'private' && c.payer === user.id) return acc + c.baseAmount;
                if (c.type === 'public' && c.splitters.includes(user.id)) return acc + (c.baseAmount / c.splitters.length);
                return acc;
            }, 0);

            // ÊèõÁÆó HKD È°ØÁ§∫
            const toHKD = (thb) => (thb * (exchangeRates ? exchangeRates['HKD'] : 0.23)).toFixed(0);

            return (
                <div id="wallet" className="px-4 pb-12 pt-8">
                    <h2 className="font-serif text-2xl text-dark mb-4 px-2 flex items-center gap-2"><Icon name="book" className="text-accent"/> ÊóÖË°åÂ∏≥Êú¨</h2>
                    
                    <div className="bg-white p-4 rounded-3xl flex justify-between items-center relative overflow-hidden shadow-soft border border-white text-center mb-6">
                        <div>
                             <div className="text-[10px] text-gray-500 mb-1 font-bold">Á∏ΩÈñãÊîØ</div>
                             <div className="text-3xl font-serif font-bold text-dark">‡∏ø{(publicTotal).toFixed(0)}</div>
                             <div className="text-[8px] text-gray-400">‚âàHKD{toHKD(publicTotal)}</div>
                        </div>
                        <div className="border-l border-r border-gray-100 px-4">
                             <div className="text-[10px] text-gray-500 mb-1 font-bold">ÊØè‰∫∫Êáâ‰ªò</div>
                             <div className="text-xl font-bold text-accent">‡∏ø{(publicTotal / 8).toFixed(0)}</div>
                             <div className="text-[8px] text-gray-400">‚âàHKD{toHKD(publicTotal/8)}</div>
                        </div>
                        <div className="bg-primary/10 rounded-xl p-2">
                             <div className="text-[10px] text-primary mb-1 font-bold">ÂÄã‰∫∫ÈñãÊîØ</div>
                             <div className="text-lg font-bold text-primary">‡∏ø{privateTotal.toFixed(0)}</div>
                             <div className="text-[8px] text-primary/70">‚âàHKD{toHKD(privateTotal)}</div>
                        </div>
                    </div>

                    <div className="mb-4 bg-white/60 p-4 rounded-2xl">
                         <div className="flex justify-between items-center cursor-pointer mb-2" onClick={() => setIsBalancesExpanded(!isBalancesExpanded)}>
                             <h3 className="font-bold text-xs text-gray-400">ÊàêÂì°ÁµêÁÆóÁãÄÊÖã (THB)</h3>
                             <Icon name={isBalancesExpanded ? "chevron-up" : "chevron-down"} size={16} className="text-gray-400"/>
                        </div>
                        {isBalancesExpanded && (
                            <div className="grid grid-cols-2 gap-2 mt-2">
                                {MEMBERS.map(m => {
                                     const val = balances[m.id];
                                     return <div key={m.id} className="flex justify-between items-center text-xs bg-white p-2 rounded-xl shadow-sm"><span className="flex items-center gap-1">{m.avatar} {m.name}</span><span className={val>=0?'text-green-600 font-bold':'text-red-500 font-bold'}>{val>=0?`+${val.toFixed(0)}`:`${val.toFixed(0)}`}</span></div>
                                })}
                            </div>
                        )}
                    </div>

                    <div className="bg-white p-5 rounded-3xl shadow-soft space-y-4 border border-white transition-all">
                        {!expenseMode ? (
                            <div className="flex gap-2">
                                <button onClick={() => setExpenseMode('public')} className="btn-primary flex-1 py-3 flex items-center justify-center gap-2"><Icon name="plus" size={18}/> Ë®òÂÖ¨Â∏≥</button>
                                <button onClick={() => setExpenseMode('private')} className="btn-secondary flex-1 py-3 flex items-center justify-center gap-2"><Icon name="user-plus" size={18}/> Ë®òÁßÅÂ∏≥</button>
                            </div>
                        ) : (
                            <>
                                <div className="flex justify-between items-center"><span className="text-xs font-bold text-gray-400">{expenseMode==='public'?'Êñ∞Â¢ûÂÖ¨Â∏≥':'Êñ∞Â¢ûÁßÅÂ∏≥'}</span><button onClick={()=>setExpenseMode(null)}><Icon name="chevron-up" size={20}/></button></div>
                                <div className="flex gap-2 items-center">
                                    <input type="number" placeholder="ÈáëÈ°ç" value={cost} onChange={e=>setCost(e.target.value)} className="flex-1 bg-bg p-3 rounded-xl text-xl font-bold outline-none"/>
                                    <select value={currency} onChange={e=>setCurrency(e.target.value)} className="bg-bg p-3 rounded-xl text-sm font-bold"><option value="THB">THB</option><option value="HKD">HKD</option></select>
                                    <div className="text-right text-xs font-bold px-1 min-w-[60px]"><div className={currency==='THB'?'text-dark text-lg':'text-gray-400 text-sm'}>‡∏ø{currency==='THB'?cost:(cost*4.3).toFixed(1)}</div><div className={currency==='HKD'?'text-dark text-base':'text-gray-400 text-xs'}>HKD ${currency==='HKD'?cost:(cost/4.3).toFixed(1)}</div></div>
                                </div>
                                <input placeholder="È†ÖÁõÆÂêçÁ®± (Ëá™ÂãïÂàÜÈ°û)" value={item} onChange={e=>setItem(e.target.value)} className="w-full bg-bg p-3 rounded-xl text-sm outline-none"/>
                                {expenseMode === 'public' && (
                                    <>
                                        <div><label className="text-xs text-gray-400 font-bold mb-1 block">Ë™∞‰ªòÈå¢</label><div className="person-selector">{MEMBERS.map(m=><div key={m.id} onClick={()=>setPayer(m.id)} className={`person-item ${payer===m.id?'selected':'unselected'}`}><div className="person-avatar">{m.avatar}</div><span className="person-name">{m.name}</span></div>)}</div></div>
                                        <div><div className="flex justify-between mb-1"><label className="text-xs text-gray-400 font-bold">Ë™∞ÂàÜÊî§</label><button onClick={toggleAll} className="text-[10px] text-accent">ÂÖ®ÈÅ∏/Ê∏ÖÁ©∫</button></div><div className="person-selector">{MEMBERS.map(m=><div key={m.id} onClick={()=>toggleSplitter(m.id)} className={`person-item ${splitters.includes(m.id)?'selected':'unselected'}`}><div className="person-avatar">{m.avatar}</div><span className="person-name">{m.name}</span></div>)}</div></div>
                                    </>
                                )}
                                <div className="flex gap-2"><button onClick={()=>setExpenseMode(null)} className="flex-1 bg-gray-100 py-3 rounded-xl font-bold text-gray-500">ÂèñÊ∂à</button><button onClick={addExpense} className="flex-[2] bg-dark text-white py-3 rounded-xl font-bold shadow-lg">Âä†ÂÖ•Â∏≥Êú¨</button></div>
                            </>
                        )}
                    </div>
                    <button onClick={() => setShowHistoryModal(true)} className="w-full text-center text-sm text-gray-500 font-bold py-3 bg-white rounded-xl border border-gray-100 hover:bg-gray-50 mt-4 flex items-center justify-center gap-2"><Icon name="scroll-text" size={16}/> Êü•ÁúãÂÖ®ÈÉ®Á¥ÄÈåÑ</button>
                    
                    {showHistoryModal && <ExpensesHistoryModal expenses={expenses} onClose={() => setShowHistoryModal(false)} onDelete={deleteExpense} filterMode={historyFilter} setFilterMode={setHistoryFilter} sortMode={historySort} setSortMode={setHistorySort} />}
                </div>
            );
        };

        const UniversalDetailSheet = ({ item, onClose, type }) => {
            const [activeImgDesc, setActiveImgDesc] = useState("ÈªûÊìäÁÖßÁâáÊü•ÁúãÊõ¥Â§öÁ¥∞ÁØÄ...");
            const isGuide = type === 'guide';
            const title = item.title || item.name;
            const tag = item.type || item.tag;
            const desc1 = item.desc || item.desc_1;
            const desc2 = item.galleryDesc || item.desc_2;
            const img = item.img || item.cover;
            const gallery = isGuide ? item.gallery1 : item.gallery;
            const location = item.location || item.name; 
            const thai = item.thai_text;

            let displayGallery = [];
            if(isGuide) {
                 displayGallery = [...(item.gallery1||[]), ...(item.gallery2||[])];
            } else {
                 // For itinerary, take first 6.
                 displayGallery = (item.gallery || []).slice(0, 6);
            }
            // Ensure exactly 6 items for grid, or less if not enough.
            const gridItems = displayGallery.slice(0,6);

            return (
                <div className="fixed inset-0 z-[100] flex flex-col justify-end">
                    <div className="modal-overlay" onClick={onClose}></div>
                    <div className="modal-content animate-slide-up">
                        <div className="modal-handle-bar" onClick={onClose}><div className="modal-drag-line"></div><div className="modal-close-text mt-1">‰∏ãÊãâÈóúÈñâ</div></div>
                        <div className="p-6 pt-2 space-y-6">
                            <div className="relative h-56 w-full rounded-2xl overflow-hidden shadow-sm">
                                <img src={img} className="w-full h-full object-cover" />
                                <div className="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div>
                                <div className="absolute bottom-4 left-4">
                                    <span className="bg-accent text-white text-[10px] px-2 py-1 rounded-md font-bold uppercase inline-block mb-1 shadow-sm">{tag}</span>
                                    <h1 className="text-2xl font-serif font-bold text-white leading-tight">{title}</h1>
                                </div>
                            </div>
                            <div className="flex gap-2">
                                <button className="flex-1 py-2 bg-gray-100 rounded-xl text-xs font-bold text-gray-600 flex items-center justify-center gap-1 hover:bg-gray-200" onClick={()=>window.open(`https://www.google.com/search?q=${title}`,'_blank')}><Icon name="globe" size={14}/> ÂÆòÁ∂≤</button>
                                <button className="flex-1 py-2 bg-gray-100 rounded-xl text-xs font-bold text-gray-600 flex items-center justify-center gap-1 hover:bg-gray-200" onClick={()=>window.open(`https://www.youtube.com/results?search_query=${title} Pattaya`,'_blank')}><Icon name="youtube" size={14}/> ÂΩ±Áâá</button>
                                <button className="flex-1 py-2 bg-gray-100 rounded-xl text-xs font-bold text-gray-600 flex items-center justify-center gap-1 hover:bg-gray-200" onClick={()=>window.open(`https://www.instagram.com/explore/tags/${title.replace(/\s/g,'')}/`,'_blank')}><Icon name="instagram" size={14}/> IG</button>
                            </div>
                            <div><h3 className="font-bold text-dark mb-2 text-sm">‚ú® ‰∫ÆÈªû‰ªãÁ¥π</h3><p className="text-sm text-gray-600 leading-relaxed bg-white p-4 rounded-2xl border border-gray-100 shadow-sm">{desc1}</p></div>
                            
                             {/* 6-Grid Gallery - 5th item (index 4) is Text */}
                             {gridItems.length > 0 && (
                                <div>
                                    <h4 className="font-bold text-dark text-sm mb-3 flex items-center gap-2"><Icon name="image" size={16} className="text-accent" /> Á≤æÂΩ©Áû¨Èñì</h4>
                                    <div className="ig-6-grid">
                                        {gridItems.map((g, i) => {
                                            const url = g.url || g; 
                                            if (i === 4) return <div key={i} className="ig-center-text">{activeImgDesc}</div>;
                                            return <div key={i} className="ig-cell" onClick={() => setActiveImgDesc(g.desc || "Êü•ÁúãË©≥ÊÉÖ")}><img src={url} /></div>;
                                        })}
                                    </div>
                                </div>
                            )}

                            {desc2 && ( <div><p className="text-sm text-gray-600 leading-relaxed bg-white p-4 rounded-2xl border border-gray-100 shadow-sm">{desc2}</p></div> )}
                            {thai && ( <div className="bg-primary/10 rounded-2xl p-4 flex items-center justify-between border border-primary/20"><div><div className="text-[10px] text-primary font-bold mb-1">SHOW TO DRIVER</div><div className="text-xl font-bold text-dark">{thai}</div></div><Icon name="copy" size={20} className="text-primary cursor-pointer"/></div> )}
                            <div><h4 className="font-bold text-dark mb-2 text-sm">üìç ‰ΩçÁΩÆÂ∞éËà™</h4><div className="square-map shadow-soft overflow-hidden rounded-2xl"><iframe loading="lazy" allowFullScreen src={`https://www.google.com/maps?q=${encodeURIComponent(location)}&output=embed`}></iframe></div><button className="w-full mt-3 bg-dark text-white py-3 rounded-xl font-bold text-sm flex items-center justify-center gap-2 btn-press shadow-md" onClick={() => window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(location)}`, '_blank')}><Icon name="map-pin" size={16} /> ÈñãÂïü Google Maps</button></div>
                        </div>
                    </div>
                </div>
            );
        };

        const ExpensesHistoryModal = ({ expenses, onClose, onDelete, filterMode, setFilterMode, sortMode, setSortMode }) => {
            const filtered = expenses.filter(ex => {
                if (filterMode === 'ALL') return true;
                if (filterMode === 'PUBLIC') return ex.type === 'public';
                if (filterMode === 'PRIVATE') return ex.type === 'private';
                return true;
            });
            const sorted = [...filtered].sort((a, b) => {
                 if (sortMode === 'DATE') return b.id - a.id;
                 if (sortMode === 'COST') return b.cost - a.cost;
                 return 0;
            });

            return (
                <div className="fixed inset-0 z-[100] flex flex-col justify-end bg-black/50 backdrop-blur-sm animate-fade-in">
                    <div className="modal-content animate-slide-up" style={{height: '60vh', background: '#F9FAFB'}}> 
                         <div className="modal-handle-bar" onClick={onClose}><div className="modal-drag-line"></div></div>
                        <div className="p-4 bg-white shadow-sm flex justify-between items-center sticky top-0 z-10">
                            <h2 className="text-xl font-bold text-dark">Â∏≥Êú¨Á¥ÄÈåÑ</h2>
                        </div>
                        <div className="p-4 space-y-2 bg-white">
                             <div className="flex gap-2 overflow-x-auto no-scrollbar items-center">
                                {['ALL', 'PUBLIC', 'PRIVATE'].map(m => (
                                    <button key={m} onClick={() => setFilterMode(m)} className={`filter-btn ${filterMode === m ? 'active' : ''}`}>{m === 'ALL' ? 'ÂÖ®ÈÉ®' : m === 'PUBLIC' ? 'ÂÖ¨Â∏≥' : 'ÂÄã‰∫∫'}</button>
                                ))}
                            </div>
                        </div>
                        <div className="flex-1 overflow-y-auto p-4 pb-20 bg-gray-50/50">
                            <div className="grid grid-cols-2 gap-4">
                                <div className="space-y-3"><h4 className="text-xs font-bold text-gray-400 text-center mb-2">ÂÖ¨Â∏≥Á¥ÄÈåÑ</h4>{sorted.filter(e=>e.type==='public').map(ex => <ExpenseCard key={ex.id} ex={ex} onDelete={onDelete} />)}</div>
                                <div className="space-y-3 border-l border-gray-100 pl-2"><h4 className="text-xs font-bold text-gray-400 text-center mb-2">ÂÄã‰∫∫Á¥ÄÈåÑ</h4>{sorted.filter(e=>e.type==='private').map(ex => <ExpenseCard key={ex.id} ex={ex} onDelete={onDelete} />)}</div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        const ExpenseCard = ({ ex, onDelete }) => {
            let catColor = 'bg-white';
            if(ex.category === '‰∫§ÈÄö') catColor = 'bg-blue-50';
            if(ex.category === 'È£≤È£ü') catColor = 'bg-orange-50';
            if(ex.category === 'Ë≥ºÁâ©') catColor = 'bg-pink-50';
            return (
                <div className={`relative overflow-hidden rounded-xl bg-white shadow-sm border border-gray-100 group ${catColor} p-2`}>
                   <button className="absolute right-1 top-1 text-gray-300 hover:text-red-500" onClick={() => onDelete(ex.id)}><Icon name="x" size={14}/></button>
                   <div className="flex flex-col gap-1">
                       <div className="flex items-center gap-1"><div className="cat-tag static w-auto h-auto bg-transparent text-gray-400 p-0"><Icon name="bookmark" size={12} fill="currentColor"/></div><span className="text-[10px] font-bold text-gray-500">{ex.category}</span></div>
                       <div className="text-sm font-bold text-dark truncate">{ex.item}</div>
                       <div className="flex justify-between items-end mt-1"><div className="text-[9px] text-gray-400">{MEMBERS.find(m => m.id === ex.payer)?.name} ‰ªò ‚Ä¢ {ex.type==='public'?'ÂÖ¨':'ÁßÅ'}</div><div className="text-right leading-tight"><div className="font-bold text-dark text-xs">‡∏ø{ex.cost}</div>{ex.inputCurrency !== 'THB' && <div className="text-[8px] text-gray-400">{ex.inputCurrency}</div>}</div></div>
                   </div>
               </div>
            )
        }

        /* --- MainApp --- */
        const MainApp = ({ user, setUser }) => {
            const [selectedItem, setSelectedItem] = useState(null); 
            const [selectedType, setSelectedType] = useState(null); 
            const [activeDay, setActiveDay] = useState('d1');
            const [menuOpen, setMenuOpen] = useState(false);
            const [filter, setFilter] = useState("ÂÖ®ÈÉ®");
            const [isGuideExpanded, setIsGuideExpanded] = useState(false);
            const [expandedDay, setExpandedDay] = useState(null);
            
            const [quickRateInput, setQuickRateInput] = useState('');
            const [leftCurr, setLeftCurr] = useState('THB');
            const [rightCurr, setRightCurr] = useState('HKD');
            const exchangeRates = useExchangeRates();

            const toggleDay = (id) => setExpandedDay(expandedDay === id ? null : id);
            
            const scrollTo = (id) => { 
                const el = document.getElementById(id); 
                if (el) { 
                    window.scrollTo({ top: el.offsetTop - 220, behavior: 'smooth' }); 
                    setActiveDay(id); 
                } 
                if(id.startsWith('d')) setExpandedDay(id);
            };

            const filteredGuide = filter === "ÂÖ®ÈÉ®" ? GUIDE_ITEMS : GUIDE_ITEMS.filter(i => i.category === filter);
            const displayedGuide = isGuideExpanded ? filteredGuide : filteredGuide.slice(0, 9);
            const openDetail = (item, type) => { setSelectedItem(item); setSelectedType(type); };
            
            // ÈõôÂêëÂåØÁéá (ÂÖ¨Âºè: ÈáëÈ°ç * (TargetRate / SourceRate))
            const quickRateOutput = exchangeRates ? (parseFloat(quickRateInput || 0) * (exchangeRates[rightCurr] / exchangeRates[leftCurr])).toFixed(2) : '...';

            // Â∑•ÂÖ∑
            const [adminNote, setAdminNote] = useState("Ê≠°ËøéÂ§ßÂÆ∂ÔºÅ");
            const [personalNote, setPersonalNote] = useState("");
            const [saveStatus, setSaveStatus] = useState("Â∑≤ÂêåÊ≠•");
            const savePersonalNote = () => { localStorage.setItem(`pattaya_note_${user.id}`, personalNote); setSaveStatus("ÂÑ≤Â≠òÊàêÂäüÔºÅ"); setTimeout(() => setSaveStatus("Â∑≤ÂêåÊ≠•"), 2000); };
            const saveAdmin = () => { localStorage.setItem('admin_note', adminNote); };
            const [isNoteEditing, setIsNoteEditing] = useState(false);

            const handleSwitchUser = (newUser) => {
                setUser(newUser);
                localStorage.setItem('pattaya_user', JSON.stringify(newUser));
            };

            return (
                <div className="min-h-screen bg-bg relative animate-fade-in pl-0 pb-20">
                    <HeroHeader user={user} />
                    
                    <div className="relative z-20 mb-2 mt-2 px-6 flex justify-center"><div className="flex gap-3 w-max bg-white/60 backdrop-blur rounded-2xl p-2 shadow-sm border border-white/50">{WEATHER_DATA.map((w, i) => (<div key={i} className="flex flex-col items-center min-w-[45px]"><span className="text-[9px] text-gray-400 font-bold mb-0.5">{w.date}</span><Icon name={w.icon} size={18} className="text-primary" /><span className="text-[10px] font-bold text-dark mt-0.5">{w.temp}</span></div>))}</div></div>
                    
                    <div className="px-6 mb-4 flex justify-center mt-4">
                        <div className="bg-white/80 backdrop-blur rounded-full p-2 pl-4 pr-4 shadow-sm border border-white flex items-center gap-2 w-full max-w-xs">
                             <select value={leftCurr} onChange={e=>setLeftCurr(e.target.value)} className="bg-transparent text-xs font-bold text-gray-500 outline-none"><option value="THB">THB</option><option value="HKD">HKD</option><option value="TWD">TWD</option><option value="USD">USD</option><option value="CNY">CNY</option><option value="JPY">JPY</option></select>
                             <input type="number" value={quickRateInput} onChange={e => setQuickRateInput(e.target.value)} className="bg-transparent w-full outline-none font-bold text-dark text-center" placeholder="Ëº∏ÂÖ•" />
                             <span className="text-xs font-bold text-gray-400">‚âà</span>
                             <span className="text-xs font-bold text-primary">{quickRateOutput}</span>
                             <select value={rightCurr} onChange={e=>setRightCurr(e.target.value)} className="bg-transparent text-xs font-bold text-primary outline-none"><option value="HKD">HKD</option><option value="THB">THB</option><option value="TWD">TWD</option><option value="USD">USD</option><option value="CNY">CNY</option><option value="JPY">JPY</option></select>
                        </div>
                    </div>

                    <FloatingTopNav user={user} activeDay={activeDay} scrollTo={scrollTo} onMenuClick={() => setMenuOpen(!menuOpen)} />
                    <MenuDropdown user={user} scrollTo={scrollTo} onClose={() => setMenuOpen(false)} onSwitchUser={handleSwitchUser} isOpen={menuOpen} />

                    <div id="timeline" className="px-4 pb-12 space-y-4 relative mt-4 pl-20"> 
                        <div className="timeline-line"></div>
                        {ITINERARY.map((day, index) => (
                            <div key={index} id={day.id} className="scroll-mt-48 relative">
                                <div className="timeline-circle" onClick={() => toggleDay(day.id)}><span>{day.date}</span></div>
                                <div className="itinerary-header" onClick={() => toggleDay(day.id)}><div><h2 className="text-lg font-bold text-dark font-serif">{day.theme}</h2><p className="text-xs text-gray-400">{day.highlights}</p></div><Icon name={expandedDay === day.id ? "chevron-up" : "chevron-down"} size={16} className="text-gray-400"/></div>
                                {expandedDay === day.id && (
                                    <div className="space-y-3 pl-4 animate-slide-up pb-4">
                                        {day.details.map((item, i) => (
                                            <div key={i} onClick={() => openDetail(item, 'event')} className="event-card">
                                                <div className="flex gap-4 items-center">
                                                    <div className="flex flex-col items-center min-w-[45px] text-sm font-bold text-primary bg-primary/10 px-2 py-1 rounded-lg z-10">{item.time}</div>
                                                    <div className="flex-1 border-l-2 border-gray-100 pl-4 py-1"><div className="font-bold text-dark text-base mb-0.5 truncate">{item.title}</div><div className="text-xs text-gray-400 line-clamp-1">{item.desc}</div></div>
                                                    <div className="text-gray-300"><Icon name="chevron-right" size={16} /></div>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </div>
                        ))}
                    </div>

                    <div id="guide" className="px-4 pb-12 pt-8 bg-white/50 rounded-t-[2.5rem]">
                        <h2 className="font-serif text-2xl text-dark mb-6 px-2 flex items-center gap-2"><Icon name="compass" className="text-accent"/> ÊóÖÈÅäÊåáÂçó</h2>
                        <div className="flex justify-center gap-2 overflow-x-auto no-scrollbar mb-4">{['ÂÖ®ÈÉ®', '‰ΩèÂÆø', 'ÁæéÈ£ü', 'Áé©Ê®Ç', 'Ë≥ºÁâ©'].map(c => (<button key={c} onClick={() => setFilter(c)} className={`pill-btn ${filter === c ? 'active' : ''}`}>{c}</button>))}</div>
                        <div className="grid grid-cols-3 gap-3">
                            {displayedGuide.map((item, i) => (
                                <div key={item.id} className="bg-white rounded-xl overflow-hidden shadow-soft btn-press cursor-pointer relative group aspect-square hover:shadow-lg transition-shadow" onClick={() => openDetail(item, 'guide')}><div className="relative h-full"><img src={item.cover || item.img} className="w-full h-full object-cover" /><div className="absolute top-1 right-1 bg-white/90 backdrop-blur px-1.5 py-0.5 rounded text-[8px] font-bold text-dark shadow-sm z-10">{item.tag || item.type}</div></div></div>
                            ))}
                        </div>
                        {!isGuideExpanded && filteredGuide.length > 9 && <button onClick={() => setIsGuideExpanded(true)} className="w-full mt-4 py-3 bg-white border border-gray-200 rounded-xl text-gray-400 text-xs font-bold flex items-center justify-center gap-1 hover:bg-gray-50">Êü•ÁúãÊõ¥Â§ö <Icon name="chevron-down" size={14}/></button>}
                        {isGuideExpanded && <button onClick={() => setIsGuideExpanded(false)} className="w-full mt-4 py-3 bg-white border border-gray-200 rounded-xl text-gray-400 text-xs font-bold flex items-center justify-center gap-1 hover:bg-gray-50">Êî∂Ëµ∑ <Icon name="chevron-up" size={14}/></button>}
                    </div>

                    <ExpenseModule user={user} />
                    
                    <div id="tools" className="px-4 pb-12 pt-8 bg-white/50 rounded-t-[2.5rem]">
                        <h2 className="font-serif text-3xl text-dark mb-6 px-2 flex items-center gap-2"><Icon name="wrench" className="text-accent" size={28}/> ÂØ¶Áî®Â∑•ÂÖ∑</h2>
                        <div className="grid grid-cols-2 gap-4">
                            <div id="board" className="bg-[#F2E6E1] p-4 rounded-3xl shadow-sm flex flex-col aspect-square"><div className="flex justify-between items-center mb-1"><h3 className="font-bold text-accent text-lg flex items-center gap-1"><Icon name="megaphone" size={24} /> ÂÖ¨Âëä</h3><button onClick={() => setIsNoteEditing(!isNoteEditing)} className="text-[10px] bg-white px-2 py-1 rounded text-accent font-bold">Edit</button></div><div className="text-sm text-dark leading-relaxed overflow-y-auto flex-1 font-medium p-1">{isNoteEditing ? <textarea value={adminNote} onChange={e=>setAdminNote(e.target.value)} className="w-full h-full bg-white/50 p-1 rounded"/> : adminNote}</div></div>
                            <div id="memo" className="bg-[#EAEAEA] p-4 rounded-3xl shadow-sm flex flex-col aspect-square"><h3 className="font-bold text-dark mb-1 text-lg flex items-center gap-1"><Icon name="edit-3" className="text-gray-500" size={24} /> Á≠ÜË®ò</h3><textarea value={personalNote} onChange={e => setPersonalNote(e.target.value)} className="flex-1 bg-white p-2 rounded-xl text-sm outline-none resize-none mb-1" placeholder="ÂØ´Èªû‰ªÄÈ∫º..."></textarea></div>
                            <div className="bg-white p-4 rounded-3xl shadow-sm col-span-2 aspect-auto border border-gray-100"><h3 className="font-bold text-dark text-lg mb-2">ÊóÖ‰º¥ÂÆàÂâá</h3><ul className="space-y-1 text-sm text-gray-500 font-medium"><li>1. Âòà‰∫§ÁΩ∞Èå¢ $500</li><li>2. ÊãíÁµïÊ±ÇÂÖ∂</li><li>3. Èõ¢ÈöäÂ†±ÂÇô</li><li>4. ÊÉÖÁ∑íÂÉπÂÄº</li></ul>
                                <div className="grid grid-cols-2 gap-2 mt-4"><a href="tel:1155" className="bg-red-50 rounded-xl p-2 flex items-center justify-center text-red-500 border border-red-100 gap-1 text-xs font-bold"><Icon name="phone" size={14}/> ÊóÖÈÅäË≠¶ÂØü 1155</a><a href="tel:191" className="bg-gray-50 rounded-xl p-2 flex items-center justify-center text-gray-500 border border-gray-100 gap-1 text-xs font-bold"><Icon name="ambulance" size={14}/> ÊïëË≠∑Ëªä 191</a></div>
                            </div>
                        </div>
                    </div>

                    <div id="memory" className="px-4 pb-32 pt-8 text-center h-[30vh] flex flex-col items-center justify-center">
                        <div className="w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mb-4 text-primary animate-bounce"><Icon name="image" size={24} /></div>
                        <h2 className="text-lg font-bold text-dark mb-2">‰πù‰∫îËá≥Â∞äÁõ∏Á∞ø</h2>
                        <div className="flex gap-2 mb-4 overflow-x-auto w-full px-4 no-scrollbar">
                             {MOCK_GALLERY.map((url, i) => (
                                 <img key={i} src={url} className="w-20 h-20 object-cover rounded-lg shadow-sm flex-shrink-0" />
                             ))}
                        </div>
                        <button onClick={() => window.open('https://photos.app.goo.gl/n5zJ1oK1gwm2JKS58', '_blank')} className="bg-primary text-white px-6 py-2.5 rounded-xl font-bold btn-press shadow-lg shadow-primary/30 flex items-center gap-2 text-xs"><Icon name="external-link" size={14} /> ÂâçÂæÄÂÖ±‰∫´Áõ∏Á∞ø</button>
                    </div>

                    {selectedItem && <UniversalDetailSheet item={selectedItem} type={selectedType} onClose={() => setSelectedItem(null)} />}
                </div>
            );
        };

        const App = () => {
            const [user, setUser] = useState(null);
            useEffect(() => {
                const loader = document.getElementById('loading');
                if(loader) loader.style.display = 'none';
                
                const defaultUser = MEMBERS[0];
                setUser(defaultUser);
                localStorage.setItem('pattaya_user', JSON.stringify(defaultUser));
            }, []);
            
            if (!user) return null; 
            return <MainApp user={user} setUser={setUser} />;
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>